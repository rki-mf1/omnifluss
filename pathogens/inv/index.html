
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../prerequisites/">
      
      
        <link rel="next" href="../../contributions/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.6">
    
    
      
        <title>Influenza - Omnifluss documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.558e4712.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#influenza" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Omnifluss documentation" class="md-header__button md-logo" aria-label="Omnifluss documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Omnifluss documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Influenza
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Omnifluss documentation" class="md-nav__button md-logo" aria-label="Omnifluss documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Omnifluss documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../prerequisites/" class="md-nav__link">
        Prerequisites
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Influenza
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Influenza
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-the-pipeline" class="md-nav__link">
    Updating the pipeline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reproducibility" class="md-nav__link">
    Reproducibility
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inputs" class="md-nav__link">
    Inputs
  </a>
  
    <nav class="md-nav" aria-label="Inputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-sheet" class="md-nav__link">
    Sample sheet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#segment-database" class="md-nav__link">
    Segment database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kraken-database" class="md-nav__link">
    Kraken database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adapter-file" class="md-nav__link">
    Adapter file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
    <nav class="md-nav" aria-label="Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resume" class="md-nav__link">
    resume
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    Output
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contributions/" class="md-nav__link">
        Contributions
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-the-pipeline" class="md-nav__link">
    Updating the pipeline
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reproducibility" class="md-nav__link">
    Reproducibility
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inputs" class="md-nav__link">
    Inputs
  </a>
  
    <nav class="md-nav" aria-label="Inputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-sheet" class="md-nav__link">
    Sample sheet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#segment-database" class="md-nav__link">
    Segment database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kraken-database" class="md-nav__link">
    Kraken database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adapter-file" class="md-nav__link">
    Adapter file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
    <nav class="md-nav" aria-label="Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resume" class="md-nav__link">
    resume
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    Output
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="influenza">Influenza</h1>
<p><strong>Omnifluss</strong> can perform genome reconstruction of Influenza viruses using Illumina short-read NGS data.</p>
<h2 id="usage">Usage</h2>
<p>Basic usage of omnifluss to reconstruct virus genomes:</p>
<pre><code class="language-bash">nextflow run rki-mf1/omnifluss \
    -profile singularity \
    --input samplesheet.csv \
    --outdir results
</code></pre>
<p>This command launches a basic omnifluss run with samples from the <em>samplesheet</em>, tasks executed within <em>singularity</em> containers, and results stored in an output folder called <em>results</em>.
We configured and optimised many settings and <a href="#parameters">Parameters</a> to reconstruct Influenza virus genomes from Illumina paired-end (PE) short-read data.
These configurations can be trivially added to the basic omnifluss run via another profile:</p>
<pre><code class="language-bash">nextflow run rki-mf1/omnifluss \
    -profile singularity,INV_illumina \
    --input samplesheet.csv \
    --outdir results
</code></pre>
<p>See the <a href="#output">Output</a> chapter for the documentation of omnifluss' outputs.
Remember that the commands above use your last cached version (see <a href="#updating-the-pipeline">Updating the pipeline</a>) of omnifluss.
If you like to run omnifluss at a specific release version, use the <code>-r</code> parameter of Naxtflow:</p>
<pre><code class="language-bash">nextflow run rki-mf1/omnifluss \
    -profile singularity,INV_illumina \
    --input samplesheet.csv \
    --outdir results \
    -r v0.2.0
</code></pre>
<p>Further, you can resume an interrupted or broken pipeline runs via <a href="#resume">resume</a>.</p>
<h3 id="updating-the-pipeline">Updating the pipeline</h3>
<p>When you run the commands above, Nextflow automatically pulls the pipeline code from GitHub and stores it as a cached version.
When running the pipeline, it will use a cached version by default if available - even if the pipeline has been updated on the developers' side.
To make sure that you're running the latest version of the omnifluss, you can manually update the cached version of the pipeline via</p>
<pre><code class="language-bash">nextflow pull rki-mf1/omnifluss
</code></pre>
<p>Again, you can add <code>-r</code> for a specific version</p>
<pre><code class="language-bash">nextflow pull -r v0.2.0 rki-mf1/omnifluss
</code></pre>
<h3 id="reproducibility">Reproducibility</h3>
<p>To ensures that a specific version of the pipeline is used when running the pipeline, you can specify the pipeline version.
If you keep using the same tag, you'll be running the same version of the pipeline, even if there have been changes to the code afterwards.
You can visit the release page at <a href="https://github.com/rki-mf1/omnifluss/releases">rki-mf1/omnifluss releases</a> and find the latest pipeline version at the top of the website.
When running the pipeline with <code>-r</code> (one hyphen), use eg. <code>-r v0.2.1</code>.
You can switch to another version any time by changing the vertion tag after the <code>-r</code> flag.
The version of the release will be written to the nextlow log for reproducibility.</p>
<h2 id="inputs">Inputs</h2>
<h3 id="sample-sheet">Sample sheet</h3>
<p>The samples to be analysed are provided to omnifluss via a sample sheet (.csv) using the <code>--input</code> parameter.
It specifies the raw read sequence data files (.fastq) used by omnifluss.
For instance:</p>
<pre><code class="language-csv">sample,fastq_1,fastq_2
INV_ILL_NB1,/path/to/experiment_NB1_R1.fastq.gz,/path/to/experiment_NB1_R2.fastq.gz
INV_ILL_NB2,/path/to/experiment_NB2_R1.fastq.gz,/path/to/experiment_NB2_R2.fastq.gz
INV_ILL_NB3,/path/to/experiment_NB3_R1.fastq.gz,/path/to/experiment_NB3_R2.fastq.gz
</code></pre>
<p>which refers to the structured information</p>
<table>
<thead>
<tr>
<th>sample</th>
<th>fastq_1</th>
<th>fastq_2</th>
</tr>
</thead>
<tbody>
<tr>
<td>INV_ILL_NB1</td>
<td>/path/to/experiment_NB1_R1.fastq.gz</td>
<td>/path/to/experiment_NB1_R2.fastq.gz</td>
</tr>
<tr>
<td>INV_ILL_NB2</td>
<td>/path/to/experiment_NB2_R1.fastq.gz</td>
<td>/path/to/experiment_NB2_R2.fastq.gz</td>
</tr>
<tr>
<td>INV_ILL_NB3</td>
<td>/path/to/experiment_NB3_R1.fastq.gz</td>
<td>/path/to/experiment_NB3_R2.fastq.gz</td>
</tr>
</tbody>
</table>
<p>The argument parser will auto-detect the sample and paired-end information provided by the samples sheet.
Technically, the sample sheet can have as many columns as desired, however, only the first three columns are required and have to match the definition table below.</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sample</code></td>
<td>Custom sample name. This entry might be identical for multiple sequencing libraries/runs from the same sample. Spaces in sample names are automatically converted to underscores (<code>_</code>).</td>
</tr>
<tr>
<td><code>fastq_1</code></td>
<td>Full path to FastQ file for Illumina short reads 1. File has to be gzipped and have the extension ".fastq.gz" or ".fq.gz".</td>
</tr>
<tr>
<td><code>fastq_2</code></td>
<td>Full path to FastQ file for Illumina short reads 2. File has to be gzipped and have the extension ".fastq.gz" or ".fq.gz".</td>
</tr>
</tbody>
</table>
<h3 id="segment-database">Segment database</h3>
<p>\&lt;WIP></p>
<h3 id="kraken-database">Kraken database</h3>
<p>\&lt;WIP></p>
<h3 id="adapter-file">Adapter file</h3>
<p>You can especify a plain FASTA file for adapter clipping.
E.g. for <em>Illumina Nextera Transposase adapter</em></p>
<pre><code>&gt;Illumina Nextera Transposase adapter fwd
TCGTCGGCAGCGTCAGATGTGTATAAGAGACAG
&gt;Illumina Nextera Transposase adapter rev
GTCTCGTGGGCTCGGAGATGTGTATAAGAGACAG
</code></pre>
<h2 id="parameters">Parameters</h2>
<blockquote>
<p><strong><em>Note:</em></strong>
The documentation of pipeline parameters is generated automatically from the pipeline schema. Options are part of Nextflow and use a <em>single</em> hyphen (pipeline parameters use a double-hyphen).</p>
</blockquote>
<p>Besides the very crucial parameters explained in <a href="#inputs">Inputs</a>, various parameters can be finetuned thoughout the workflow.
You can find the full list of parameters via <code>nextflow run rki-mf1/omnifluss -r &lt;release-tag&gt; --help</code>.
In order to not bloat the omnifluss run command and save time when typing the run for repeatedly you can provide pipeline parameters in <code>JSON</code> or <code>YAML</code> format via <code>-params-file &lt;file&gt;</code>.</p>
<blockquote>
<p><strong><em>Warning:</em></strong>
Do not use the <code>-c &lt;file&gt;</code> to specify pipeline parameters as this will result to errors!
Custom config files specified in <code>-c</code> must only be used for <a href="https://nf-co.re/docs/usage/configuration#tuning-workflow-resources">tuning process resource specifications</a> or module arguments (args).</p>
</blockquote>
<p>For instance, the basic use case of omnifluss above can be specified with a params-file in yaml format:</p>
<pre><code class="language-bash">nextflow run rki-mf1/omnifluss -profile singularity -params-file params.yaml
</code></pre>
<p>with:</p>
<pre><code class="language-yaml">input: 'samplesheet.csv'
outdir: 'results'
</code></pre>
<h3 id="resume"><code>resume</code></h3>
<p>Specify <em>-resume</em> when restarting a pipeline.
Nextflow will use cached results from any pipeline steps where the inputs are the same, continuing from where it got to previously.
For input to be considered the same, not only the names must be identical but the files' contents as well.
For more info about this parameter, see <a href="https://www.nextflow.io/blog/2019/demystifying-nextflow-resume.html">this blog post</a>.</p>
<p>You can also supply a run name to resume a specific run: <code>-resume [run-name]</code>.
Use the <code>nextflow log</code> command to show previous run names.</p>
<h2 id="output">Output</h2>
<p>After a successful run, the pipeline creates the following files and folders in your working directory:</p>
<pre><code class="language-bash">work                # Directory containing the Nextflow working files
&lt;outdir&gt;            # Results in specified location (defined with --outdir)
.nextflow_log       # Log file from Nextflow
</code></pre>
<p>\&lt;WIP></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.51d95adb.min.js"></script>
      
        <script src="../../search/main.js"></script>
      
    
  </body>
</html>